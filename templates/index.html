<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Atlas faune et flore</title>

        <!-- Bootrap -->
        <link rel="stylesheet" href="{{url_for('static', filename='/lib/bootstrap/css/bootstrap.min.css') }}"></link>
        <script type=text/javascript src="{{url_for('static', filename='lib/bootstrap/js/bootstrap.min.js') }}"></script>

        <!-- Jquery -->
        <script type=text/javascript src="{{url_for('static', filename='/lib/jquery-1.12.4.min.js') }}"></script>
        <link rel="stylesheet" href="{{url_for('static', filename='lib/jquery-ui.css') }}" />
		
		<!-- Leaflet -->
        <link rel="stylesheet" href="{{url_for('static', filename='/lib/leaflet/leaflet.css') }}" />
        <script src="{{url_for('static', filename='/lib/leaflet/leaflet.js') }}"></script>
        <script src="{{url_for('static', filename='lib/leaflet/leaflet-fullscreen/leafletFullScreen.min.js') }}"></script>
        <link rel="stylesheet" href="{{url_for('static', filename='lib/leaflet/leaflet-fullscreen/leafletFullScreen.css') }}" />

        <!-- CSS Application -->
        <link rel="stylesheet" href="{{url_for('static', filename='css/atlas.css') }}" />
        <link rel="stylesheet" href="{{url_for('static', filename='css/index.css') }}" />
        <link rel="stylesheet" href="{{url_for('static', filename='custom/custom.css') }}" />


				
    </head>

    <body>

        {% include 'navbar.html' %}

		<div class="container-fluid">
						<!-- SAUT DE LIGNE -->
			<div class="col-sm-12" style="height:20px"></div>
			<!-- Introduction -->
			<div class="col-sm-12">
				<div class="panel panel-default">
					<div class="row">
						<div class="col-sm-4 textIntroduction"> 
							<h1>
								Bienvenue sur l'atlas de la faune et de la flore du {{configuration.STRUCTURE}}
							</h1>
							<p>
								Il permet de consulter des fiches sur l'ensemble des espèces observées par les agents du parc national depuis sa création en 1973.
							</p>
							<p>
								Celles-ci se basent sur les observations réalisées en temps réel par les agents et présente une vue d'ensemble des espèces observées mais en aucun cas un inventaire exhaustif des espèces du territoire.
							</p>
						</div>
						<div class="col-sm-8">
							<img src="{{url_for('static', filename='custom/images/accueil-intro.jpg') }}" width="100%">
						</div>
					</div>
				</div>
			</div>
		
			<div class="col-sm-12" style="height:20px"></div>

			<!-- Statistiques -->
			<div class="col-sm-12">
				<div class="panel panel-default stat-panel">
					<div class="row">
						<div class="panel-heading"><strong> <h3> L'atlas du {{configuration.STRUCTURE}} </h3> </strong></div>
						<div class ="col-sm-3 ">
							<div class="thumbnail stat-thumbnail">
								<span class="glyphicon glyphicon-search"> </span>
								<h1> {{stat.nbTotalObs}} </h1>
								<h4> observations </h2>
								<p><a href="#mapBeginning" class="btn btn-default" role="button">Voir les {{configuration.NB_LAST_OBS}} dernières observations</a></p>
							</div>
						</div>
						<div class =" col-sm-3">
							<div class="thumbnail stat-thumbnail">
								<span class="glyphicon glyphicon-leaf"> </span>
								<h1> {{stat.nbTotalTaxons}} </h1>
								<h4> espèces </h2>
									<form method="POST" onsubmit="completeAction('#searchFormTaxonsStat', hiddenInputTaxonStat)"  action=""  id='searchFormTaxonsStat' class="navbar-form" role="search">
						               <div class="form-group has-feedback">
						                 <input id="searchTaxonsStat" type="text" class="form-control"  placeholder="Rechercher une espèce &nbsp; &nbsp; &nbsp;">
						                 <i class="glyphicon glyphicon-search form-control-feedback"></i>
						                 <input id ="hiddenInputTaxonStat"  type="hidden" name="cd_ref">
						               </div>       
            						</form>
								
							</div>
						</div>
						<div class ="col-sm-3">
							<div class="thumbnail stat-thumbnail">
								<img id="picto" src="{{url_for('static', filename='images/commune-icone.png') }}"> 
								<h1>  {{stat.town}}</h1>
								<h4> communes </h2>
									<form method="POST" onsubmit="completeAction('#searchFormCommunesStat', hiddenInputCommunesStat)" id='searchFormCommunesStat' action=""  class="navbar-form" role="search">
						               <div class="form-group has-feedback">
						                 <input id="searchCommunesStat" type="text" class="form-control"  placeholder="Rechercher une commune;" >
						                 <i class="glyphicon glyphicon-search form-control-feedback"></i>
						               	 <input id="hiddenInputCommunesStat"  type="hidden" name="insee">
						               </div>
						                 
					            	</form>
							</div>
						</div>
						<div class ="col-sm-3">
							<div class="thumbnail stat-thumbnail">
								<span class="glyphicon glyphicon-camera"> </span>
								<h1> {{stat.photo}} </h1>
								<h4> photos </h2>
								<p><a class="btn btn-default" role="button">Galerie photos</a></p>
							</div>
						</div>
						
					</div>
				</div>
			</div>

			{% if customStatMedias != None %}
			<div class="col-sm-12">
				<div class="row row-medias">
				{% for i in range(customStatMedias | length) %}
					<div class="col-sm-6 stat-medias-wrapper">
							<div class="panel panel-default statMedias">
								<div class="panel-heading">
									<strong>{{configuration.RANG_STAT_FR[i]}}</strong> <br>
									<strong>{{customStat[i].nb_obs}} </strong> observations |  <strong>{{customStat[i].nb_taxons}}</strong> espèces
								</div>
								<h5> <span class="glyphicon glyphicon-eye-open" > </span> Espèces à découvrir </h5>
					{% for j in range(3) %}
						{% if loop.index < customStatMedias[i] | length %}
								<div class="col-sm-4 col-stat-medias">
									<div class ="thumbnail-stat-medias">
										{% if customStatMedias[i][j].path == None %}
										<div class="slider-size" style="background:url({{url_for('static', filename='images/picto_' + customStatMedias[i][j].group2_inpn +'.png') }}) center center; background-size:cover;">
										{% else %}
									    <div class="slider-size" style="background:url({{customStatMedias[i][j].path}}) center center; background-size:cover;">
									    {% endif %} 
									    	<div class="stat-medias-hovereffet">
									    		<img src="{{url_for('static', filename='images/eye.png') }}"> 
									    	</div>
									    </div>
									    <div class="thumbnail-caption-medias" >
									        <p> {{customStatMedias[i][j].nom_vern}} <br> <i> {{customStatMedias[i][j].lb_nom}} </i>  </p>
									        <p><a href="{{url_for('main.ficheEspece',cd_ref=customStatMedias[i][j].cd_ref)}}" class="btn btn-default" role="button">Fiche espèce</a></p>
									    </div>
									</div>
								</div>	
						{% endif %}				
				{% endfor %}
							</div>
					</div>

			{% endfor %}
				</div>
			</div>
			{% endif %}

			
			<!-- Dernières espèces observées -->
			<div class="col-sm-12"> 
					  <!-- CARTO des 100 dernières observations -->
					  <div class="panel panel-default">
					  	<div class="panel-heading" id="mapBeginning"><strong> Les {{configuration.NB_LAST_OBS}} dernières observations </strong></div>
					  	<div class="row" id="mapRow">
							 <div class="col-sm-8">
								<div id="map"> </div>
							 </div>
							 <div id="listMap" class = "col-sm-4"> 
								<table id='tableEspece' class="table table-striped">
									
									<tbody>
										{% for obs in observations %}
										<tr class='tabEspece'>
											{% if obs.urlImage == None %}
											<td class="singleTaxon img"> <img class="singleTaxon" width="80%" src="{{url_for('static', filename='images/picto_' + obs.group2_inpn +'.png') }}"> </td>
											{% else %}
											<td class="singleTaxon img"> <img width="15px" height="15px" src="{{configuration.URL_PHOTO}}{{obs.url}}"> </td>
											{% endif %}
											<td class="singleTaxon name" idSynthese = "{{obs.id_synthese}}" cdref="{{obs.cd_ref}}" > {{obs.taxon}}</td>
											<td class="singleTaxon" idSynthese = "{{obs.id_synthese}}"> {{obs.dateobs}} </td>
											<td> <a href = "{{url_for('main.ficheEspece',cd_ref=obs.cd_ref)}}"> <img height="20" width="20" src ="{{url_for('static', filename='images/logo_files.png') }}" alt="Lien vers la fiche espèce" title="Lien vers la fiche espèce"> </a> </td> 
											<td class="hiddenTd" hidden ="true"> {{obs.cd_ref}} </td>
										</tr>
										{% endfor %}
									</tbody>
								</table>	
							 </div>
						</div>

					</div>
			</div>

			
						
			<!-- SAUT DE LIGNE -->
			<div class="col-sm-12" style="height:20px"></div>
			
			<!-- ESPECES PERIODE -->
			<div class="col-sm-12"> 
				<div class="panel panel-default">
					<div class="panel-heading"><strong>Les espèces les plus observées en ce moment</strong></div>
					<div class="row thumbnail-row">
					{% for tax in mostViewTaxon %}
						<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 thumbnail-col">
						    <div class="hovereffect">
						        {% if tax.path == None %}
						        <img class="default-logo " src="{{url_for('static', filename='images/picto_' + tax.group2_inpn +'.png') }}" alt="">
						        {% else %}
						        	<img class="img-responsive-logo" src="{{tax.path}}" alt="tax.taxonName">
						        {% endif %}
						        <div class="overlay">
						           <h2>{{tax.taxonName}}</h2>	
						           <a class="info" href="{{url_for('main.ficheEspece',cd_ref=tax.cd_ref)}}">Fiche espèce</a>
						        </div>
						    </div>
						</div>
					  {% endfor %}
					
				</div>
			</div>
			
		</div>


	<!-- AJOUT CAMILLE -->	
	<script type="text/javascript" src="/atlas/static/conf/calculCustom.js"></script>
    	    <script type="text/javascript">
			  var listeTaxonsSearch = {{listeTaxonsSearch|tojson}} 
			  ,observations = {{observations|tojson}}
			  ,communesSearch = {{communesSearch|tojson}}
			  , configuration = {{configuration|tojson}},
			  url_limit_territory = "{{url_for('static', filename='territoire.json') }}";
        </script>
    
    <script src="{{url_for('static', filename='mapGenerator.js') }}"></script>
    <script src="{{url_for('static', filename='mapHome.js') }}"></script>
	<!-- FIN AJOUT CAMILLE -->		
		
	<!-- JQUERY APPELE 2 FOIS ? -->	
	
	    <script type=text/javascript src="{{url_for('static', filename='lib/jquery-1.12.4.min.js') }}"></script>
	    <script type=text/javascript src="{{url_for('static', filename='lib/jquery-ui.min.js') }}"></script>


	
		
	    <script src="{{url_for('static', filename='main.js') }}"></script>

<script> 

		</script>

    </body>
</html>